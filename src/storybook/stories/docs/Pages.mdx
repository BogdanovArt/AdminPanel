# Административная панель управления сайтом

Разработано на основе: [Vue.js](https://vuejs.org/), [typescript](https://www.typescriptlang.org/)

## Общее описание

**Основные концепции приложения:**

- максимально использовать генерацию контента административной панели на основе получаемых с бекенда данных
- обеспечить максимальное "покрытие" функционала, характерного для управления публичным контентом приложения (добавление и редактирование сущностей, их структура отображения и порядок вывода)
- обеспечить возможность управлять структурой и иерархией страниц самого приложения административной панели без необходимости доработок со стороны фронтенда

**Общий принцип работы**

При заходе в приложение (после осуществления авторизации) отправляются запросы на получение данных для генерации главного меню и корневой страницы приложения.
При переходе на дочерние страницы - через общий метод-аггрегатор запросов отправляется запрос на получение данных.
Полученные данные передаются "диспетчеру" контента, роль которого - определять тип контента и производить рендер соответствующих страниц и компонентов. Отрисованный контент может содержать элементы управления, при взаимодействии с которыми снова происходит вызов метода-аггрегатора запросов с новыми параметрами и цикл повторяется.

**Общие динамические данные страниц**

Бекенд имеет возможность управлять следующими данными на **всех** типах страниц

- Заголовок страницы: `meta.h1`
- Title страницы `meta.title`
- Хлебные крошки `meta.breadcrumbs`

## Форматы API

(Форматы ответа конкретного типа страниц указаны в stories самой страницы)

## Универсальные (общие) сущности

#### Универсальное действие

- `Действие` действия для аггрегатора запросов

| поле       | тип    | [unique](#уникальные-значения-параметров) | required | назначение                             |
| ---------- | ------ | ----------------------------------------- | -------- | -------------------------------------- |
| **method** | string | false                                     | true     | метод запроса                          |
| **url**    | string | false                                     | true     | ссылка для запроса                     |
| **route**  | string | false                                     | false    | ссылка для навигации внутри приложения |

#### Кнопка управления

- `Кнопка` основной орган управления

| поле       | тип                                 | [unique](#уникальные-значения-параметров) | required | назначение                                      |
| ---------- | ----------------------------------- | ----------------------------------------- | -------- | ----------------------------------------------- |
| **type**   | string                              | false                                     | true     | тип элемента управления                         |
| **icon**   | string                              | false                                     | true     | наименование [иконки](#иконки) эл-та управления |
| **title**  | string                              | false                                     | false    | текст кнопки (подсказки)                        |
| **action** | [Действие](#универсальное-действие) | false                                     | false    | действие кнопки                                 |

## Страницы Таблиц

В случае, если сервер вернул данные с типом [таблица](#таблица), диспетчер страниц вызовет рендер соответсвующей страницы.
В добавление к общим параметрам, на страницах [табличного типа](#таблица) Бекенд также имеет возможность:

- задавать количество колонок таблицы - `data.data.table.headers`
- задавать ключ параметра сортировки, содержание и выравнивание текста в ячейках шапки таблицы

#### Тело Таблицы

данные таблицы (`data.data.table`)

| поле        | тип                           | [unique](#уникальные-значения-параметров) | required | назначение                     |
| ----------- | ----------------------------- | ----------------------------------------- | -------- | ------------------------------ |
| **headers** | [Ячейка](#ячейка-шапки)[]     | false                                     | false    | массив ячеек шапки таблицы     |
| **items**   | [Строка](#элементы-таблицы)[] | false                                     | false    | массив элементов строк таблицы |

#### Ячейка шапки

элемент шапки таблицы

| поле      | тип                   | [unique](#уникальные-значения-параметров) | required | назначение                               |
| --------- | --------------------- | ----------------------------------------- | -------- | ---------------------------------------- |
| **text**  | string                | false                                     | false    | текстовое содержимое ячейки              |
| **align** | left / right / center | false                                     | false    | направление выравнивания текста ячейки   |
| **sort**  | string                | true                                      | false    | ключ параметра сортировки данных таблицы |

### Элементы таблицы

Предусмотрено несколько типов элементов строк таблицы `(data.data.table.items[index])`:

#### Строка данных

- тип `items`
  Выполняет роль основного элемента таблицы (строка с заполненными данными и органами управления)

| поле      | тип                                | [unique](#уникальные-значения-параметров) | required | назначение                                                                                              |
| --------- | ---------------------------------- | ----------------------------------------- | -------- | ------------------------------------------------------------------------------------------------------- |
| **type**  | string                             | false                                     | true     | наименование типа элемента строки таблицы                                                               |
| **style** | object                             | false                                     | false    | объект с набором inline стилей https://v2.vuejs.org/v2/guide/class-and-style.html#Binding-Inline-Styles |
| **data**  | [Ячейка](#ячейки-строки-таблицы)[] | false                                     | false    | массив эл-в ячеек строки таблицы                                                                        |

#### Кнопка-строка таблицы

- тип `button`
  Выполняет роль органа управления (например, для вызова действия создания сущности таблицы).
  Также эл-ты с типом `button` дублируются в виде кнопок в верхней части страницы (в контексте тела таблицы)

| поле     | тип                                | [unique](#уникальные-значения-параметров) | required | назначение                                |
| -------- | ---------------------------------- | ----------------------------------------- | -------- | ----------------------------------------- |
| **type** | string                             | false                                     | true     | наименование типа элемента строки таблицы |
| **data** | [Ячейка](#ячейки-строки-таблицы)[] | false                                     | false    | массив эл-в ячеек строки таблицы          |

#### Ячейки строки таблицы

элемент ячейки строки таблицы

- тип `name`

| поле       | тип                                 | [unique](#уникальные-значения-параметров) | required | назначение                                                                                              |
| ---------- | ----------------------------------- | ----------------------------------------- | -------- | ------------------------------------------------------------------------------------------------------- |
| **type**   | string                              | false                                     | true     | тип ячейки таблицы                                                                                      |
| **title**  | string                              | false                                     | false    | текстовое содержимое ячейки таблицы                                                                     |
| **icon**   | string                              | false                                     | true     | наименование [иконки](#иконки) эл-та управления                                                         |
| **action** | [Действие](#универсальное-действие) | false                                     | false    | действие при взаимодействии с ячейкой                                                                   |
| **style**  | object                              | false                                     | false    | объект с набором inline стилей https://v2.vuejs.org/v2/guide/class-and-style.html#Binding-Inline-Styles |

- тип `controls` - блок управления строки таблицы

| поле      | тип                            | [unique](#уникальные-значения-параметров) | required | назначение                                                                                              |
| --------- | ------------------------------ | ----------------------------------------- | -------- | ------------------------------------------------------------------------------------------------------- |
| **type**  | string                         | false                                     | true     | наименование типа ячейки строки таблицы                                                                 |
| **items** | [Кнопка](#кнопка-управления)[] | false                                     | false    | массив органов управления ячейки                                                                        |
| **style** | object                         | false                                     | false    | объект с набором inline стилей https://v2.vuejs.org/v2/guide/class-and-style.html#Binding-Inline-Styles |

**Важно!** ячейки таблицы отрисовываются последовательно в порядке их расположения в массиве `data.table.items[index].data` - при отличии кол-ва ячеек строки от кол-ва колонок таблицы вместо отрисовки пустых ячеек эл-ты будут смещены к левому краю таблицы

## Страницы Форм

Данный тип страниц предназначен преимущественно для работы с сущностями (разделы/товары/пользователи и т.д)
Представляет собой набор динамически генерируемых полей ввода.

Основной `action` формы служит для отправки данных формы

Содержимое [формы](#form) (`data.data.form.items`) может включать следующие типы элементов:

#### Элементы управления формой

- тип `buttons` - Набор органов управления страницей формы (аналогичен подобным элементам страницы табличного типа)

| поле      | тип                            | [unique](#уникальные-значения-параметров) | required | назначение                  |
| --------- | ------------------------------ | ----------------------------------------- | -------- | --------------------------- |
| **type**  | string                         | false                                     | true     | тип элемента                |
| **items** | [Кнопка](#кнопка-управления)[] | false                                     | false    | массив элементов управления |

#### Группа полей ввода

- тип `group` - Сгруппированный (с возможностью сворачивания) набор полей ввода

| поле      | тип                    | [unique](#уникальные-значения-параметров) | required | назначение         |
| --------- | ---------------------- | ----------------------------------------- | -------- | ------------------ |
| **type**  | string                 | false                                     | true     | тип элемента       |
| **title** | string                 | false                                     | false    | заголовок группы   |
| **items** | [Инпут](#поля-ввода)[] | false                                     | false    | массив полей ввода |

## Модальные Страницы

Страницы типа "таблица" и "форма" имеют возможность открываться в двух контекстах - в "модальном" и "статичном".
Если в ответе сервера в качестве типа поля `data.type` будет указано значение `modal` - следующая загруженная страница будет отображена в "модальном" контексте. Последниее действие, совершенное в "статичном" контексте при этом сохранится. При навигации "внутри" страницы в "модальном" контексте - новый контент будет отображаться в данном контексте до тех пор, пока поле `data.type` будет иметь соответвующий тип (`modal`). История переходов в браузере будет также сохраняться, путь в адресной строке также будет модифицироваться. Как только от сервера будет получен контент со "статичным" типом, модальное окно закроется, навигация продолжится в "статичном" контексте. При принудительном закрытии модального окна будет выполнено последнее сохраненное в "статичном" контексте действие.

## Поп-ап окна

Также имеется возможность показывать сообщения / подтверждения пользователям в поп-ап контексте.
Для этого также в поле `data.type` указывается соответствующий тип `popup`.

- тип `popup`

| поле     | тип                        | [unique](#уникальные-значения-параметров) | required | назначение          |
| -------- | -------------------------- | ----------------------------------------- | -------- | ------------------- |
| **type** | string                     | false                                     | true     | тип контекста       |
| **data** | [Контент](#контент-поп-ап) | false                                     | true     | контент поп-ап окна |

### Контент поп-ап

| поле        | тип                             | [unique](#уникальные-значения-параметров) | required | назначение                                                |
| ----------- | ------------------------------- | ----------------------------------------- | -------- | --------------------------------------------------------- |
| **title**   | string                          | false                                     | false    | заголовок поп-ап окна                                     |
| **content** | string (html)                   | false                                     | false    | тело сообщения пользователю (может принимать html шаблон) |
| **buttons** | [Кнопка](#кнопка-поп-ап-окна)[] | false                                     | true     | массив сущностей [Кнопка](#кнопка-поп-ап-окна)            |

### Кнопка поп-ап окна

| поле       | тип                                 | [unique](#уникальные-значения-параметров) | required | назначение                     |
| ---------- | ----------------------------------- | ----------------------------------------- | -------- | ------------------------------ |
| **title**  | string                              | false                                     | false    | тектовое содержимое кнопки     |
| **action** | [Действие](#универсальное-действие) | false                                     | true     | действие кнопки                |
| **dark**   | boolean                             | false                                     | false    | вариант исполнения кнопки      |
| **icon**   | string                              | false                                     | false    | наименование [иконки](#иконки) |
| **color**  | string                              | false                                     | false    | цвет кнопки                    |

## Примечания

#### иконки

Чтобы выбрать необходимую иконку, можно воспользоваться сервисом https://materialdesignicons.com/.
Выбрать подходящую иконку от Google (без оранжевой рамки), и добавить к ее названию "mdi-". (Например, чтобы использовать иконку с названием account, в поле icon нужно передать "mdi-account").

#### уникальные значения параметров

Уникальность значения среди родственных сущностей. Например среди всех полей ввода формы, или всех товаров в списке вне зависимости от иерархии вывода этих элементов в JSON-дереве.
